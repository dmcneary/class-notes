# Virtual Memory
March 29, 2022

**Virtual memory (VM)** is a collection of one or more logical address spaces, which may be larger than the physical memory of the computer system. A paged virtual memory imagines a process-specific continuous space. Segmentation allows for multiple paged VM spaces per process.

## Demand Paging
**Demand paging** is a methodology which loads a page into physical memory only when the page is needed, rather than loading it immediately at the beginning of execution of the process. A **present bit** is a flag in each entry of a page table which indicates whether a page is currently stored in a frame in RAM (or other physical memory). If so, then the page table entry is a pointer to the frame which holds the page. A **page fault** is an interrupt which is triggered when a non-resident page is referenced. Granted, the entire virtual memory cannot fit in physical memory - that's the point of virtual memory! The OS is tasked to handle finding the page on the disk, copying the page into a frame, then setting the present bit to 1. Thus, through demand paging, pages are moved into RAM only as they are needed and a VM is easily implemented. The downside is that VM takes up space on physical storage, such as a disk, and as the ratio of occupied VM to RAM increases, page faults become more common, which can slow performance.

## Page Replacement
When all frames in physical memory are occupied and a page fault is triggered, a frame must be freed to accomodate the new page. **Page replacement** refers to the act of overwriting a frame in memory from the virtual memory when needed. Because moving from memory to disk is an expensive task, there must be some way to indicate that a frame from memory already exists in the same state on the disk. Thus, a **modified bit (m-bit)** is a flag in each entry of a page table which indicates whether a page has been modified during execution. If the page is modified on the disk, the bit is switched to 1 in the page table, and page replacement on the frame which holds that page will require copying the contents of the frame back to the disk.

## Paging of Tables
A VM can create address spaces much larger than the physical memory would allow. Since few programs are able to conceivably make use of such large spaces, a page table can be divided into individual pages and introduced into memory as needed via demand paging and replacement. Likewise, a segment table can also be paged. A new page table can be created to keep track of pages which compose the total segment table. The idea is that tables may be broken into smaller constituent pieces, managed by higher-order page tables.
